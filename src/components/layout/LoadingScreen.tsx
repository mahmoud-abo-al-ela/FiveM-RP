"use client";

import { useEffect, useState } from "react";

const MIN_LOADING_TIME = 2000; // 2 seconds minimum

const logoPath = `M220 33 C218.5361 36.0688 216.8599 38.9043 215 41.75 C214.4844 42.5492 213.9688 43.3484 213.4375 44.1719 C212.9631 44.7752 212.4888 45.3784 212 46 C211.34 46 210.68 46 210 46 C209.7834 46.6806 209.5669 47.3613 209.3438 48.0625 C207.5956 51.884 205.1702 54.7804 202.5 58 C201.4183 59.3273 200.3375 60.6554 199.2578 61.9844 C198.714 62.6515 198.1705 63.3186 197.6104 64.0059 C195.1512 67.051 192.7574 70.1447 190.375 73.25 C189.5784 74.2864 188.7817 75.3228 187.9609 76.3906 C186.5858 78.2205 185.2697 80.0955 184 82 C183.34 82 182.68 82 182 82 C181.7938 82.66 181.5875 83.32 181.375 84 C179.5088 88.0718 177.0244 91.688 174 95 C173.34 95 172.68 95 172 95 C171.6326 95.8121 171.6326 95.8121 171.2578 96.6406 C169.7065 99.5506 167.8329 102.0974 165.875 104.75 C164.7883 106.2273 164.7883 106.2273 163.6797 107.7344 C163.1254 108.482 162.5711 109.2297 162 110 C161.34 109.67 160.68 109.34 160 109 C160.758 107.3197 160.758 107.3197 161.5313 105.6055 C162.1878 104.133 162.844 102.6603 163.5 101.1875 C163.8339 100.4495 164.1677 99.7115 164.5117 98.9512 C164.8275 98.239 165.1434 97.5268 165.4688 96.793 C165.9086 95.8111 165.9086 95.8111 166.3574 94.8093 C167.1673 92.8488 167.1673 92.8488 167 90 C167.66 90 168.32 90 169 90 C169.33 88.02 169.66 86.04 170 84 C166.2802 84.3815 163.2238 85.2548 159.8594 86.8125 C155.187 88.9326 150.4577 90.8622 145.6875 92.75 C143.9283 93.4491 142.1692 94.1483 140.4102 94.8477 C139.517 95.2023 138.6238 95.557 137.7036 95.9224 C135.048 96.9809 132.3964 98.0492 129.7461 99.1211 C121.2629 102.547 112.7782 105.8293 104.1367 108.8359 C100.0179 110.3645 96.0671 112.1793 92.1094 114.082 C90 115 90 115 88 115 C88.0516 115.892 88.1031 116.784 88.1563 117.7031 C88.1563 123.4988 86.7011 129.1082 85.5 134.75 C85.0287 136.9943 84.5599 139.239 84.0938 141.4844 C83.8843 142.4715 83.6748 143.4586 83.459 144.4756 C82.9106 147.0643 82.9106 147.0643 83 150 C84.0274 150.5685 85.0548 151.137 86.1133 151.7227 C93.4899 155.8267 100.7491 159.9808 107.7656 164.6875 C110.0356 166.0209 111.3949 166.7074 114 167 C116.5922 165.9424 116.5922 165.9424 119.2539 164.2461 C120.2742 163.6383 121.2945 163.0305 122.3457 162.4043 C123.4073 161.7553 124.4688 161.1062 125.5625 160.4375 C127.6462 159.1847 129.7308 157.9334 131.8164 156.6836 C133.369 155.7497 133.369 155.7497 134.9529 154.7969 C138.6706 152.6045 142.4524 150.5505 146.2512 148.5032 C151.1657 145.8157 155.9833 142.962 160.8125 140.125 C173.6484 132.6094 173.6484 132.6094 180 129 C187.5576 124.7027 195.0592 120.3097 202.5645 115.9219 C204.5101 114.7847 206.4572 113.6498 208.4058 112.5176 C210.0143 111.5766 211.6163 110.6243 213.2075 109.6543 C214.7718 108.712 216.3813 107.8453 218 107 C218.66 107.33 219.32 107.66 220 108 C208.7295 118.3876 208.7295 118.3876 203.5 123.0625 C202.9122 123.5897 202.3244 124.117 201.7188 124.6602 C199.9042 126.0747 198.0872 127.0434 196 128 C196 128.66 196 129.32 196 130 C195.34 130 194.68 130 194 130 C194 130.66 194 131.32 194 132 C193.34 132 192.68 132 192 132 C192 132.66 192 133.32 192 134 C190.3203 135.7266 190.3203 135.7266 188.125 137.625 C187.4057 138.2566 186.6864 138.8883 185.9453 139.5391 C184 141 184 141 182 141 C182 141.66 182 142.32 182 143 C180.3203 144.7266 180.3203 144.7266 178.125 146.625 C177.4057 147.2566 176.6864 147.8883 175.9453 148.5391 C174 150 174 150 172 150 C171.505 151.485 171.505 151.485 171 153 C169.2227 154.8242 169.2227 154.8242 167.0625 156.6875 C166.3522 157.3101 165.642 157.9327 164.9102 158.5742 C163 160 163 160 161 160 C161 160.66 161 161.32 161 162 C159.4877 163.3302 157.9133 164.5903 156.3125 165.8125 C152.6213 168.6927 149.223 171.5928 146 175 C144.3716 176.7041 142.7123 178.3803 141 180 C140.34 180 139.68 180 139 180 C139 180.66 139 181.32 139 182 C137.3555 183.6914 137.3555 183.6914 135.1875 185.5625 C134.4798 186.1825 133.7721 186.8026 133.043 187.4414 C131 189 131 189 128 190 C128 190.66 128 191.32 128 192 C123.5294 196 123.5294 196 121 196 C120.7319 196.6188 120.4638 197.2375 120.1875 197.875 C119 200 119 200 116 202 C112.201 201.6643 109.5044 200.3464 106.2773 198.3828 C105.4092 197.8582 104.541 197.3335 103.6465 196.793 C102.7525 196.2425 101.8586 195.6921 100.9375 195.125 C100.0397 194.5823 99.1418 194.0396 98.2168 193.4805 C91.5824 189.4455 91.5824 189.4455 88.8499 187.355 C86.8751 185.9085 85.3451 185.5661 83 185 C82.67 184.34 82.34 183.68 82 183 C81.3813 182.8556 80.7625 182.7113 80.125 182.5625 C77.5672 181.8854 76.8471 180.8519 75 179 C73.7863 178.2142 72.5426 177.4732 71.2773 176.7734 C70.5742 176.3816 69.871 175.9897 69.1465 175.5859 C68.4175 175.1863 67.6886 174.7867 66.9375 174.375 C65.8383 173.764 65.8383 173.764 64.7168 173.1406 C60.8876 171.0151 60.8876 171.0151 57 169 C57 168.34 57 167.68 57 167 C56.2163 166.6906 55.4325 166.3813 54.625 166.0625 C52 165 52 165 50 164 C51.2353 151.4625 53.7078 139.3135 56.3608 127.0098 C57.5202 121.5504 58.5893 116.0729 59.6558 110.5947 C60.0896 108.3932 60.5398 106.1961 61 104 C61.1491 103.2639 61.2981 102.5279 61.4517 101.7695 C62.3038 97.915 62.9244 95.4997 66 93 C68.2014 91.8967 68.2014 91.8967 70.7539 90.8789 C72.1606 90.3114 72.1606 90.3114 73.5957 89.7324 C74.5748 89.3463 75.5539 88.9603 76.5625 88.5625 C77.5145 88.1803 78.4665 87.7981 79.4473 87.4043 C81.3599 86.6374 83.2739 85.8743 85.1895 85.1147 C87.881 84.0472 90.5677 82.9678 93.2539 81.8867 C97.2733 80.2784 101.3132 78.7479 105.375 77.25 C114.0802 74.011 122.6936 70.5535 131.3086 67.083 C136.8479 64.854 142.3937 62.6413 147.9385 60.426 C154.3458 57.8649 160.7505 55.2973 167.1527 52.7234 C171.1568 51.1142 175.1617 49.5072 179.1668 47.9003 C181.1579 47.1009 183.1487 46.3005 185.1391 45.4991 C216.1867 33 216.1867 33 220 33 Z`;

export function LoadingScreen() {
  const [progress, setProgress] = useState(0);

  useEffect(() => {
    const interval = setInterval(() => {
      setProgress((p) => (p >= 100 ? 0 : p + 2));
    }, 30);

    return () => clearInterval(interval);
  }, []);

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center bg-background">
      <div className="absolute inset-0 overflow-hidden">
        <div className="absolute inset-0 bg-[linear-gradient(rgba(128,0,255,0.03)_1px,transparent_1px),linear-gradient(90deg,rgba(128,0,255,0.03)_1px,transparent_1px)] bg-[size:50px_50px]" />
      </div>

      <div className="relative flex flex-col items-center gap-6">
        <div className="absolute inset-0 blur-2xl opacity-30">
          <svg viewBox="0 0 256 256" className="w-40 h-40">
            <path d={logoPath} fill="hsla(0, 0%, 100%, 1.00)" />
          </svg>
        </div>

        <svg viewBox="0 0 256 256" width="160" height="160">
          <defs>
            <mask id="logo-mask">
              <path d={logoPath} fill="white" />
            </mask>
          </defs>
          <path d={logoPath} fill="hsla(0, 0%, 97%, 1.00)" opacity="0.2" />
          <rect
            x="0"
            y="0"
            width="256"
            height={(progress * 256) / 100}
            fill="hsla(0, 0%, 100%, 1.00)"
            mask="url(#logo-mask)"
          />
        </svg>
      </div>
    </div>
  );
}

interface LoadingProviderProps {
  children: React.ReactNode;
}

export function LoadingProvider({ children }: LoadingProviderProps) {
  const [isLoading, setIsLoading] = useState(true);

  useEffect(() => {
    const timer = setTimeout(() => {
      setIsLoading(false);
    }, MIN_LOADING_TIME);

    return () => clearTimeout(timer);
  }, []);

  if (isLoading) {
    return <LoadingScreen />;
  }

  return <>{children}</>;
}
